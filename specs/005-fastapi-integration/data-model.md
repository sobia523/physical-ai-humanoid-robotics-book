# Data Model: RAG Chatbot FastAPI Backend Integration

**Feature**: RAG Chatbot â€” FastAPI Backend Integration
**Date**: 2025-12-29
**Branch**: 005-fastapi-integration

## Entity Definitions

### QuestionRequest
Represents a user's request to ask a question to the RAG agent.

**Fields**:
- `query` (str): The main question text from the user
- `selected_text` (str, optional): Additional context text selected by the user (default: None)

**Validation Rules**:
- `query` must not be empty
- `query` length must be between 1 and 2000 characters
- `selected_text` if provided, must be between 1 and 5000 characters

### AnswerResponse
Represents the response from the RAG agent to a user's question.

**Fields**:
- `answer` (str): The answer generated by the agent
- `sources` (list[dict]): List of source documents/references used in the answer
- `confidence` (float): Confidence score of the answer (0.0 to 1.0)
- `timestamp` (str): ISO 8601 formatted timestamp of the response
- `context_used` (str, optional): Context that was used to generate the answer

**Validation Rules**:
- `answer` must not be empty
- `confidence` must be between 0.0 and 1.0
- `timestamp` must be in ISO 8601 format
- `sources` must be a list of valid source objects

### Source
Represents a source document referenced in the answer.

**Fields**:
- `url` (str): URL of the source document
- `title` (str): Title of the source document
- `module` (str): Module name in the book structure
- `chapter` (str): Chapter name in the book structure
- `heading` (str): Section heading for the content
- `relevance_score` (float): Similarity score between query and source

**Validation Rules**:
- `url` must be a valid URL format
- `title` must not be empty
- `relevance_score` must be between 0.0 and 1.0

### HealthCheck
Represents the health status of the API service.

**Fields**:
- `status` (str): Health status ("healthy", "unhealthy", "degraded")
- `timestamp` (str): ISO 8601 formatted timestamp of the check
- `dependencies` (dict): Status of external dependencies

**Validation Rules**:
- `status` must be one of the allowed values
- `timestamp` must be in ISO 8601 format

## API Contract Models

### AskRequest
Request model for the `/ask` endpoint.

**Fields**:
- `query` (str): The question to ask

### AskSelectedRequest
Request model for the `/ask-selected` endpoint.

**Fields**:
- `query` (str): The question to ask
- `selected_text` (str): The text selected by the user for context

### ErrorResponse
Standard error response format.

**Fields**:
- `error` (str): Error message
- `detail` (str, optional): Additional error details
- `timestamp` (str): ISO 8601 formatted timestamp