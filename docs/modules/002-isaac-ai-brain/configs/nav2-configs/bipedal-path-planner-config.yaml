# Nav2 Path Planner Configuration for Bipedal Humanoid Robots
# This configuration addresses navigation challenges specific to legged locomotion
# including step planning, balance constraints, and dynamic stability

planner_server:
  ros__parameters:
    use_sim_time: True
    planner_plugins: ["BipedalGridBased"]
    BipedalGridBased:
      plugin: "nav2_navfn_planner::NavfnPlanner"
      tolerance: 0.5
      use_astar: false
      allow_unknown: true
      # Bipedal-specific path planning parameters
      step_size: 0.5
      min_distance: 0.8
      # Bipedal-specific cost calculation for step planning
      # Considers terrain passability for bipedal locomotion
      costmap_topic: "global_costmap/costmap_raw"
      footprint_topic: "global_costmap/published_footprint"
      allow_unknown: true
      planner_window_x: 0.0
      planner_window_y: 0.0
      planner_frequency: 1.0

# Bipedal-specific path smoother
path_smoother_server:
  ros__parameters:
    use_sim_time: True
    smoother_plugins: ["simple_smoother"]
    simple_smoother:
      plugin: "nav2_smoother::SimpleSmoother"
      tolerance: 1.0e-10
      max_its: 1000
      do_refinement: True
      # Bipedal-specific smoothing parameters for stable path following
      smoothing_cost_scale: 0.05
      smoothing_size_scale: 0.9

# Bipedal-specific trajectory generator
# Handles step planning and balance constraints
smoother_server:
  ros__parameters:
    use_sim_time: True
    smoother_plugins: ["simple_smoother"]
    simple_smoother:
      plugin: "nav2_smoother::SimpleSmoother"
      tolerance: 1.0e-10
      max_its: 1000
      do_refinement: True
      smoothing_cost_scale: 0.05
      smoothing_size_scale: 0.9

# Bipedal-specific obstacle inflation for step planning
global_costmap:
  global_costmap:
    ros__parameters:
      use_sim_time: True
      plugins:
        - {name: static_layer, type: "nav2_costmap_2d::StaticLayer"}
        - {name: obstacle_layer, type: "nav2_costmap_2d::ObstacleLayer"}
        - {name: inflation_layer, type: "nav2_costmap_2d::InflationLayer"}
      obstacle_layer:
        enabled: True
        observation_sources: scan
        scan:
          topic: /scan
          max_obstacle_height: 2.0
          clearing: True
          marking: True
          data_type: "LaserScan"
          raytrace_max_range: 3.0
          raytrace_min_range: 0.0
          obstacle_max_range: 2.5
          obstacle_min_range: 0.0
      inflation_layer:
        enabled: True
        cost_scaling_factor: 3.0
        inflation_radius: 0.7
        # Bipedal-specific inflation to account for step planning requirements
        inflate_unknown: false
      static_layer:
        map_subscribe_transient_local: True
      always_send_full_costmap: True